# Plugins
# Plugin declarations, configurations, and PowerKit status bar

# fzf-url configuration
set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'
set -g @fzf-url-history-limit '2000'

# Plugin declarations
set -g @plugin 'tmux-plugins/tpm'                # Tmux Plugin Manager
set -g @plugin 'tmux-plugins/tmux-sensible'      # Sensible default settings

set -g @plugin 'sainnhe/tmux-fzf'                    # Fuzzy finder integration
set -g @plugin 'wfxr/tmux-fzf-url'                   # URL extraction and opening
set -g @plugin 'fabioluciano/tmux-powerkit'          # PowerKit status bar (fork with padding fix)
set -g @plugin 'christoomey/vim-tmux-navigator'      # Seamless vim/tmux navigation
set -g @plugin 'jabirali/tmux-tilish'                # i3-like window management
set -g @plugin 'lloydbond/tmux-floating-terminal'    # Floating terminal windows

# Tilish plugin configuration (i3-like window management)
set -g @tilish-default 'main-vertical'
set -g @tilish-enforce 'size'
set -g @tilish-navigator 'off'                       # Ensures Alt+hjkl always navigates panes

# PowerKit status bar configuration (custom Catppuccin Mocha theme)
set -g @powerkit_theme "custom"
set -g @powerkit_custom_theme_path "$TMUX_CONFIG_DIR/scripts/powerkit-theme.sh"

set -g @powerkit_separator_style "rounded"
set -g @powerkit_transparent "true"
set -g @powerkit_elements_spacing "false"
set -g @powerkit_status_order "session,plugins"

# Disable PowerKit reload binding (conflicts with prefix+r rename-window)
set -g @powerkit_reload_config_key ""

# Reload config with cache clear (prefix+R)
bind-key R run-shell "rm -rf ~/.cache/tmux-powerkit/data/*" \; source-file ~/.config/tmux/tmux.conf \; display-message "Cache cleared & config reloaded"

# Plugins: hostname, directory (via external), git, datetime
set -g @powerkit_plugins 'hostname,external("󰉋"|"#{b:pane_current_path}"|"#fab387"|"#fcc9a3"|"0"),git,datetime'

# Datetime - 12-hour format
set -g @powerkit_plugin_datetime_format "time-12h"

# Responsive status bar - progressively hide plugins on narrow terminals
# Hide order: datetime → hostname → directory+git → session (last)
# Override breakpoints: set -g @powerkit_bp_full "160"  (etc.)
set-hook -g client-resized "run-shell -b '$TMUX_CONFIG_DIR/scripts/powerkit-responsive.sh'"
set-hook -g client-session-changed "run-shell -b '$TMUX_CONFIG_DIR/scripts/powerkit-responsive.sh'"
