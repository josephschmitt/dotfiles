[metadata]
name = "projects"
description = "A channel to select from directories"
requirements = ["pj", "sesh", "nvim"]

[source]
command = [
  "pj --icons --max-depth 3 --exclude .github",
  "pj --no-cache --icons --max-depth 3 --exclude .github",
  "pj --no-nested --icons --max-depth 3 --exclude .github"
]
ansi = true
output = "{strip_ansi|split: :1}"

[preview]
command = "lt --color=always '{strip_ansi|split: :1}'"

[keybindings]
enter = "actions:connect"
ctrl-e = "actions:edit"
ctrl-t = "actions:new_tab"
ctrl-v = "actions:nvim_tab"
ctrl-c = ["actions:clear_cache", "reload_source"]

[actions.connect]
description = "Connect to selected session"
command = "sesh connect '{strip_ansi|split: :1}'"
mode = "execute"

[actions.edit]
description = "Open in $EDITOR"
command = "$EDITOR '{strip_ansi|split: :1}'"
mode = "execute"

[actions.new_tab]
description = "Open in new tmux tab"
command = "tmux new-window -c '{strip_ansi|split: :1}'"
mode = "execute"

[actions.nvim_tab]
description = "Open in neovim in new tmux tab"
command = "tmux new-window -c '{strip_ansi|split: :1}' nvim"
mode = "execute"

[actions.clear_cache]
description = "Clear fdp cache and reload"
command = "fdp --clear-cache"
mode = "fork"
